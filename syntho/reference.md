# é¡ºé“ä»£ç åº“ API å‚è€ƒ

## å®Œæ•´å‚æ•°æ–‡æ¡£

### GET /api/projects

åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»£ç é¡¹ç›®ã€‚

**å‚æ•°**

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| pattern | string | å¦ | - | é¡¹ç›®å/æè¿°è¿‡æ»¤è¯ |
| limit | int | å¦ | 50 | è¿”å›æ•°é‡é™åˆ¶ |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": [
    {
      "id": "/gitlab/syntho-robot",
      "name": "syntho-robot",
      "description": "æœºå™¨äººæ ¸å¿ƒæœåŠ¡",
      "branch": "main",
      "fileCount": 1234
    }
  ],
  "meta": { "total": 10, "limit": 50 }
}
```

---

### GET /api/tree

æµè§ˆç›®å½•ç»“æ„ï¼Œæ”¯æŒé€’å½’éå†å’Œæ–‡ä»¶è¿‡æ»¤ã€‚

**å‚æ•°**

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| path | string | **æ˜¯** | - | ç›®å½•è·¯å¾„ï¼Œå¦‚ `/`, `/src/` |
| project | string | å¦ | - | é¡¹ç›®åï¼Œä¸ä¼ åˆ™æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›® |
| pattern | string | å¦ | - | æ–‡ä»¶è¿‡æ»¤æ¨¡å¼ï¼Œå¦‚ `*.java`, `*.yml` |
| depth | int | å¦ | 2 | é€’å½’æ·±åº¦ï¼Œ-1ä¸ºæ— é™ |
| format | string | å¦ | json | è¾“å‡ºæ ¼å¼ï¼š`json` æˆ– `tree` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "path": "/src/",
    "project": "syntho-robot",
    "content": "ğŸ“ src/\nâ”œâ”€â”€ ğŸ“ main/\nâ””â”€â”€ ğŸ“ test/"
  }
}
```

---

### GET /api/search

è¯­ä¹‰æœç´¢ä»£ç å’Œæ–‡æ¡£ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€‚

**å‚æ•°**

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| q | string | **æ˜¯** | - | æœç´¢å…³é”®è¯ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€ |
| project | string | å¦ | - | é™å®šé¡¹ç›®ï¼Œä¸ä¼ åˆ™å…¨å±€æœç´¢ |
| types | string | å¦ | all | æ–‡æ¡£ç±»å‹ï¼š`all`, `api`, `java`, `general`ï¼Œç”¨`\|`åˆ†éš” |
| limit | int | å¦ | 10000 | è¿”å›å†…å®¹çš„tokensæ•°é‡ |
| paths | string | å¦ | - | è·¯å¾„åŒ…å«è¿‡æ»¤ï¼Œé€—å·åˆ†éš”ï¼Œå¦‚ `/api/,/controller/` |
| exclude | string | å¦ | - | è·¯å¾„æ’é™¤è¿‡æ»¤ï¼Œé€—å·åˆ†éš”ï¼Œå¦‚ `/test/,/.git/` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "query": "ç”¨æˆ·ç™»å½•",
    "project": "all",
    "types": "all",
    "content": "## æœç´¢ç»“æœ\n\n### UserController.java\n..."
  }
}
```

**types è¯´æ˜**

| å€¼ | åŒ¹é…å†…å®¹ |
|------|----------|
| all | æ‰€æœ‰ç±»å‹ |
| api | APIæ¥å£ã€Controllerã€RESTç«¯ç‚¹ |
| java | Javaæºä»£ç  |
| general | é€šç”¨æ–‡æ¡£ã€Markdownã€é…ç½®æ–‡ä»¶ |

---

### GET /api/content

è·å–æ–‡ä»¶çš„å®Œæ•´æºç å†…å®¹ã€‚

**å‚æ•°**

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| path | string | **æ˜¯** | - | æ–‡ä»¶è·¯å¾„æˆ–æ–‡ä»¶å |
| start | int | å¦ | 1 | èµ·å§‹è¡Œå· |
| end | int | å¦ | - | ç»“æŸè¡Œå·ï¼ˆä¸limitäº’æ–¥ï¼‰ |
| limit | int | å¦ | 2000 | æœ€å¤§è¡Œæ•°ï¼ˆä¸endäº’æ–¥ï¼‰ |

**è·¯å¾„æ ¼å¼æ”¯æŒ**

1. å®Œæ•´è·¯å¾„ï¼š`context7-repos/syntho-robot-main/src/UserController.java`
2. é¡¹ç›®å†…è·¯å¾„ï¼š`src/main/java/UserController.java`
3. ä»…æ–‡ä»¶åï¼š`UserController.java`ï¼ˆæœç´¢åŒ¹é…ï¼‰

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "path": "UserController.java",
    "startLine": 1,
    "endLine": null,
    "maxLines": 2000,
    "content": "/*\n * é¡¹ç›®ä¿¡æ¯:\n * - é¡¹ç›® ID: syntho-robot\n..."
  }
}
```

---

## é«˜çº§ç”¨æ³•

### ç»„åˆæŸ¥è¯¢ç¤ºä¾‹

**1. è·¨é¡¹ç›®æœç´¢ç‰¹å®šç±»å‹ä»£ç **
```
/api/search?q=Redisç¼“å­˜&types=java&paths=/service/,/cache/
```

**2. æŸ¥æ‰¾æ‰€æœ‰é…ç½®æ–‡ä»¶**
```
/api/tree?path=/&pattern=*.yml&depth=10
```

**3. æ’é™¤æµ‹è¯•ä»£ç æœç´¢**
```
/api/search?q=æ•°æ®åº“è¿æ¥&exclude=/test/,/mock/
```

**4. åˆ†é¡µæŸ¥çœ‹å¤§æ–‡ä»¶**
```
# ç¬¬1-100è¡Œ
/api/content?path=BigFile.java&start=1&end=100

# ç¬¬101-200è¡Œ
/api/content?path=BigFile.java&start=101&end=200
```

### é”™è¯¯å¤„ç†

**404 - èµ„æºä¸å­˜åœ¨**
```json
{
  "success": false,
  "error": "æ–‡ä»¶æœªæ‰¾åˆ°: xxx.java"
}
```

**400 - å‚æ•°é”™è¯¯**
```json
{
  "success": false,
  "error": "å‚æ•° path æ˜¯å¿…å¡«çš„"
}
```

**500 - æœåŠ¡å™¨é”™è¯¯**
```json
{
  "success": false,
  "error": "å†…éƒ¨é”™è¯¯ä¿¡æ¯"
}
```

---

## æ€§èƒ½å»ºè®®

1. **é™åˆ¶æœç´¢èŒƒå›´**ï¼šä½¿ç”¨ `project` å’Œ `paths` å‚æ•°ç¼©å°æœç´¢èŒƒå›´
2. **æ§åˆ¶è¿”å›é‡**ï¼šå¤§é¡¹ç›®ä½¿ç”¨è¾ƒå°çš„ `limit` å€¼
3. **åˆ†æ®µè¯»å–**ï¼šå¤§æ–‡ä»¶ä½¿ç”¨ `start/end` å‚æ•°åˆ†é¡µè¯»å–
4. **æµ…å±‚éå†**ï¼šç›®å½•æµè§ˆä½¿ç”¨è¾ƒå°çš„ `depth` å€¼
